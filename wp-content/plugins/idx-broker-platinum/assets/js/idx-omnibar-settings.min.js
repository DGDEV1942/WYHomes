window.addEventListener("DOMContentLoaded",function(){function e(e,t,n){for(var o=0;o<e.length;o++)t.call(n,e[o],o)}function t(){jQuery(".select2").select2({maximumSelectionLength:10,placeholder:"Select Up to Ten Fields"})}function n(){"undefined"!=typeof p&&p.addEventListener("click",function(e){e.preventDefault(),jQuery(".status").fadeIn("fast").html(y+"Saving Settings..."),d()})}function o(){e(m,function(e){e.addEventListener("change",l)})}function i(){jQuery(v).on("change",a)}function l(){return e(m,function(e){var t=e.name,n=e.value;"basic"!==t&&r(t,n)}),a()}function r(t,n){var o=v.querySelectorAll("."+t)[0],i=o.querySelectorAll("option");return e(i,function(e){e.getAttribute("data-mlsptid")!==n?e.disabled=!0:e.disabled=!1}),c(v)}function c(e){return jQuery(e).select2("destroy"),jQuery(e).select2()}function a(){u();var t=v.selectedOptions;e(t,function(e){try{if(e.disabled===!0)throw e}catch(t){s(t.title)}})}function u(){document.querySelectorAll(".select2-container--default")[0].classList.remove("warning"),h.style.display="none",h.querySelector("p").innerHTML=""}function s(e){var t=e+" is not in the selected property type. Please choose a Custom Field within the selected MLS Specific Property Type.<br>";h.querySelector("p").insertAdjacentHTML("beforeend",t),h.style.display="block",document.querySelectorAll(".select2-container--default")[0].classList.add("warning")}function d(){if("undefined"!=typeof document.querySelectorAll(".city-list")[0]){var e=jQuery(".city-list select").val(),t=jQuery(".county-list select").val(),n=jQuery(".zipcode-list select").val();jQuery.post(ajaxurl,{action:"idx_update_omnibar_current_ccz","city-list":e,"county-list":t,"zipcode-list":n},function(){f()})}}function f(){if(void 0!==v.options){for(var e=[],t=0;t<v.options.length;t++)if(v.options[t].selected){var n=v.options[t].parentNode.classList[0],o=v.options[t].value,i=v.options[t].label,l=v.options[t].getAttribute("data-mlsptid"),r={idxID:n,value:o,mlsPtID:l,name:i};e.push(r)}for(var c=[],t=0;t<m.length;t++){var n=m[t].name,o=m[t].value,a={idxID:n,mlsPtID:o};c.push(a)}var u=document.querySelectorAll(".omnibar-placeholder")[0].value;jQuery.post(ajaxurl,{action:"idx_update_omnibar_custom_fields",fields:e,mlsPtIDs:c,placeholder:u},function(){window.location.reload()})}}"undefined"!=typeof loadOmnibarView&&jQuery.post(ajaxurl,{action:"idx_preload_omnibar_settings_view"},function(){window.location.reload()});var p=document.querySelectorAll("#save_changes")[0],y="<span class='ajax'></span>",m=document.querySelectorAll(".omnibar-mlsPtID"),v=document.querySelectorAll(".omnibar-additional-custom-field")[0],h=document.querySelectorAll(".customFieldError")[0];!function(){t(),n(),l(),o(),i()}()});